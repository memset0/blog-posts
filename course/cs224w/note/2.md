---
title: "II. Classical Works"
sync: /course/cs224w/note/2.md
---

## 1. Lecture 2: Traditional Methods for ML on Graphs

### 1.1. Node-Level Prediction

> Goal: 找到能够描述节点在网络中结构与位置的特征 characterize the structure and position of a node in the network.

#### 1.1.1. Node Centrality

**节点中心性(node centrality)**

- **eigenvector centrality**：认为如果节点邻居重要，那么节点本身也重要。$c_v = \dfrac{1}{\lambda} \sum_{u\in N(v)} c_u \Longrightarrow \lambda \boldsymbol c = \boldsymbol{Ac}$（$\lambda$ 是正常数）
- **betweenness centrality**：认为如果一个节点处在很多节点对的最短路径上，那么这个节点是重要的。$c_v=\displaystyle\sum_{s\neq t\neq v}\dfrac{\#\text{(s 和 t 之间包含 v 的最短路径)}}{\#\text{(s 和 t 之间的最短路径)}}$。
- **closeness centrality**：认为如果一个节点距其他节点的距离最短，那么认为这个节点是重要的。$c_v = \dfrac{1}{\sum_{u\neq v} \#\text{(u 和 v 之间的最短距离)}}$。

#### 1.1.2. Clustering Coefficient

**clustering coefficient**：衡量节点邻居的连接程度。描述节点的局部结构信息。

$$
e_v = \dfrac{\#\text{(邻居之间的边的条数)}}{\binom{k_v}{2}} \in [0,1]
$$

![wollrRaH.png|324](https://static.memset0.cn/img/v6/2024/07/30/wollrRaH.png)

- Observation: Clustering Coefficient 相当于数 ego-network 中的**三角形(triangle)** 的**导出子图(induced subgraph)** 的数量。这里的有根三角形就是一种 graphlet（$G_2$）。

#### 1.1.3. Graphlets

**Graphlets**: ==rooted== connected non-isomorphic subgraphs.

![cAbcIJ3I.png|520](https://static.memset0.cn/img/v6/2024/07/30/cAbcIJ3I.png)

**图元度向量(Graphlet Degree Vector, GDV)**: A count vector of graphlets rooted at a given node.

![Uploading file...4j0sg]()

### 1.2. Link-Level Prediction

#### 1.2.1. Distance-Based Features

用两点间最短路来描述两个点之间的关系。

![QQ_1722318468269.png|308](https://static.memset0.cn/img/v6/2024/07/30/q5fSVKJ5.png)

#### 1.2.2. Local Neighborhood Overlap

如果用最短路来描述节点之间的关联，将不能捕捉到**邻域重叠(local neighborhood overlap)** 的程度：$(B,H)$ 的领域交为 $2$，相比于 $(B,E)$ 和 $(A,B)$，他们的联系应该更紧密，但最短路并不能反应这一点。

一些考虑了邻域的系数如下，用 $N(x)$ 表示节点 $x$ 的领域：

- Common neighbor: $|N(v_1)\cap N(v_2)|$。
- Jaccard's coefficient: $\dfrac{|N(v_1)\cap N(v_2)|}{|N(v_1)\cup N(v_2)|}$，归一化后的结果。
- Adamic-Adar index: $\displaystyle\sum_{u\in N(v_1)\cap N(v_2)} \dfrac{1}{\log k_u}$，这里 $k_u$ 是点 $u$ 的度数。在社交网络上表现良好：有一堆度数低的共同好友比有一堆名人共同好友的得分更高。

但如果两个点的距离 $>2$，以上统计邻域的方法就会失效。

#### 1.2.3. Global Neighborhood Overlap

**卡茨指标(Katz index)**: 统计两点直接的路径条数 _count the number of walks of all lengths between a given pair of nodes_ 可以通过**邻接矩阵(adjacent matrix)** 的幂次计算。

$$
S_{v_1 v_2} = \sum_{l=1}^\infty \beta^l \boldsymbol{A}^l_{v_1 v_2} = (\boldsymbol I-\beta \boldsymbol A)^{-1} - \boldsymbol I
$$

- discount factor: $\beta \in (0,1)$。距离更长的路径对关联性的影响应当越小。
- 可以通过**封闭形式(closed-form)** 计算 Katz index matrix。

### 1.3. Graph-Level Prediction

> Goal: We want features that characterize the structure of an entire graph.

#### Kernal Methods

**核方法(kernal methods)** 在传统的 ML for graph-level predicton 中广泛应用。

![gfY7uGN0.png|452](https://static.memset0.cn/img/v6/2024/07/31/gfY7uGN0.png)

#### Bag-of-Words

- Key Idea: **Bag-of-Words (BoW)** for a graph

以 Bag of node degrees 为例：

![5Z3oupeV.png|458](https://static.memset0.cn/img/v6/2024/07/31/5Z3oupeV.png)

#### Graphlets Kernal

如果考虑 Bag of graphlets？这里的 graphlets 和 node-level prediction 部分中的不一样，区别在于：

---
title: Ch6 Registers & Register Transfers
sync: /course/dd/note/6.md
---

## 1. 寄存器 Registers

TBD

## 2. 寄存器传输操作 Register Transfer Operations

**寄存器传输操作(register transfer operation)**：处理存储在寄存器中的数据的操作。

![CPBN1eDH.png|517](https://static.memset0.cn/img/v6/2024/05/16/CPBN1eDH.png)

**微操作(microoperation)**：关于寄存器传输的初级操作，包括 load/count/shift/add/bitwise OR 等等。

### 2.1. 寄存器传输语言 Register Transfer Language

- 字母和数字：表示寄存器
- 小括号：表示位的范围（如 `R(1)`、`PC(7:0)`）
- 箭头：表示数据的传输（如 `R1 <- R2`)
- 逗号：用于分开多次操作
- 方括号：（可通过寄存器）指定内存地址（如 `R0 <- M[AR]`）
- **条件传输(conditional transfer)**：如 `K1: (R2 <- R1)` 表示当 `K1` 寄存器的值为 1 时执行 `R2 <- R1`。

> [!note] 关于寄存器传输操作的硬件描述语言的比较
>
> ![|600](https://static.memset0.cn/img/v6/2024/05/16/cOaKwRmC.png)

如用 RTL 来描述 ALU：

$$
\begin{aligned}
\overline{\text{X}}\ \text{K1}&: \text{R1} \leftarrow \text{R1} + \text{R2}\\
\text{X}\ \text{K1} &: \text{R1} \leftarrow \text{R1} + \overline{\text{R2}} + 1
\end{aligned}
$$

### 2.2. 数据传输结构 Register Transfer Structures

#### 2.2.1. Multiplexer-Based Transfers

![BznJZfrU.png|448](https://static.memset0.cn/img/v6/2024/05/16/BznJZfrU.png)

TBD

#### 2.2.2. Dedicated MUX-Based Transfers

![Qs0chJmq.png|448](https://static.memset0.cn/img/v6/2024/05/16/Qs0chJmq.png)

- GN 的计算：MUX 的反相器是可以共享的，每一个 MUX 里需要两个 2 输入与门和一个 2 输入或门，共 $GN = 3 \times 6 + 3 = 21$。

#### 2.2.3. Multiplexer Bus

#### 2.2.4. Three-State Bus

三台总线的实现需要用到**三态门(tri-state gate)**，因为其可以输出高阻态，从而使得来自多个寄存器的输出可以直接连起来而不需要逻辑门或 MUX 的控制。

![MhJmWI1e.png|451](https://static.memset0.cn/img/v6/2024/05/16/MhJmWI1e.png)

## 3. 移位寄存器 Shift Registers

一个普通的移位寄存器如下：

![GWS45J0I.png|428](https://static.memset0.cn/img/v6/2024/05/16/GWS45J0I.png)

- **串行输入(serial input)**：In
- **串行输出(serial output)**：Out
- **并行输出(parallel output)**：A、B、C、Out

### 3.1. 平行加载移位寄存器 Parallel Load Shift Register

![yE3R4xpn.png|406](https://static.memset0.cn/img/v6/2024/05/16/yE3R4xpn.png)

通过给输入信号加一个 2-to-1 MUX 可以实现**平行加载(parallel load)** 功能，这样在 SHIFT 为 0 时，移位寄存器 $\{A,B\}$ 会直接从 $\{D_A, D_B\}$ 加载数据，并且这一加载过程在同一时间发生（是并行的）。

![aUweTYxa.png|499](https://static.memset0.cn/img/v6/2024/05/16/aUweTYxa.png)

如果需要支持**保持(hold)** 功能，可以换成 3-to-1 MUX，并接一路从自己这来的输出，功能表如下：

| Shift | Load | Operation       |
| ----- | ---- | --------------- |
| 0     | 0    | 保持 no change  |
| 0     | 1    | 加载 load       |
| 1     | x    | 移位 shift down |

注意，实现保持功能时，我们不能直接给时钟信号 CP 加一个与门，这样的话与门的延迟可能导致 **时钟歪斜问题(clock skew problem)**。实际上，在时序电路设计中，都不宜对时钟信号进行操作。

### 3.2. 双向移位寄存器 Bidirectional Shift Registers

再换用 4-to-1 MUX 可以让我们的移位寄存器同时支持两个方向的移位操作，电路的一部分如下图所示。

![r45GWNkA.png|307](https://static.memset0.cn/img/v6/2024/05/16/r45GWNkA.png)

其功能表如下（$S_1,S_0$ 为控制信号）：

| $S_1$ | $S_0$ | Operation              |
| ----- | ----- | ---------------------- |
| 0     | 0     | 保持 no change         |
| 0     | 1     | 向下移位 shift down    |
| 1     | 0     | 向上移位 shift up      |
| 1     | 1     | 平行加载 parallel load |

如果需要让移位寄存器支持更多功能，更换 MUX 并设计相应电路即可。

## 4. 计数器 Counters

|      | 纹波计数器                           | 同步计数器 |
| ---- | ------------------------------------ | ---------- |
| PROS | 实现简单，成本低<br>翻转次数少，节能 |            |
| CONS | 延迟会叠加                           |            |

### 4.1. 纹波计数器 Ripple Counter

触发器 $D_A$ 把时钟信号作为控制信号 $C_R$，其反转频率是时钟信号的一半；$D_B$ 把 $D_A$ 的输出作为控制信号，其反转频率是 $D_A$ 的一半，是时钟信号的四分之一。从而实现计数器的功能。

![q5pDrDSj.png|298](https://static.memset0.cn/img/v6/2024/05/16/q5pDrDSj.png)

### 4.2. 同步计数器 Synchronous Counters

触发器只用来保存状态，计数的功能用组合电路实现。所有触发器同步改变。

![mX2DskNH.png|351](https://static.memset0.cn/img/v6/2024/05/16/mX2DskNH.png)

### 4.3. 支持平行加载的计数器 Counter with Parallel Load

### 4.4. 模 N 的计数器 Counting Modulo N
